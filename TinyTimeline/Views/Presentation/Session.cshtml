@using TinyTimeline.Models
@model SessionModel

@{
    Layout = "Layout";
}

<link rel="stylesheet" href="~/css/site.css" asp-append-version="true"/>
<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css"/>
<script src="~/js/site.js" asp-append-version="true"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js" asp-append-version="true"></script>

<div class="margin_top">
    @Html.Partial("Menu", new MenuModel {SessionId = Model.SessionInfo.SessionId})
    @Html.DisplayFor(m => m.SessionInfo)
    
    <div class="margin_bottom">
        <label>@Html.DisplayFor(z => z.EventFilterType) events (@Model.Events.Count)</label>
    </div>
    
    @if (Model.Events.Count > 8)
    {
        <div>
            @Html.Partial("TimelineEventFilters", Model.SessionInfo.SessionId)
        </div>
    }
    
    @foreach (var e in Model.Events)
    {
        @Html.DisplayFor(m => e)
    }
    <div>
        @Html.Partial("TimelineEventFilters", Model.SessionInfo.SessionId)
        @Html.Partial("SessionButtons", Model.SessionInfo.SessionId)
    </div>
</div>

<script>
    $.each($('textarea[data-autoresize]'), function() {
        var offset = this.offsetHeight - this.clientHeight;
 
        var resizeTextarea = function(el) {
            $(el).css('height', 'auto').css('height', el.scrollHeight + offset);
        };

        resizeTextarea(this);
        $(this).on('keyup input', function() { resizeTextarea(this); }).removeAttr('data-autoresize');
    });
</script>